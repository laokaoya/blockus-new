{"ast":null,"code":"import _taggedTemplateLiteral from\"D:/blockus new/blockus-game/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8;// 主游戏组件\nimport React,{useState}from'react';import styled from'styled-components';import{useGameState}from'../hooks/useGameState';import GameBoard from'./GameBoard';import PlayerPieceLibrary from'./PlayerPieceLibrary';import AIPlayersInfo from'./AIPlayersInfo';import GameControls from'./GameControls';import{canPlacePiece}from'../utils/gameEngine';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GameContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  min-height: 100vh;\\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\\n  padding: 20px;\\n\"])));const GameHeader=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  margin-bottom: 20px;\\n\"])));const GameTitle=styled.h1(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  color: white;\\n  font-size: 36px;\\n  margin: 0;\\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);\\n\"])));const GameSubtitle=styled.p(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  color: rgba(255, 255, 255, 0.8);\\n  font-size: 18px;\\n  margin: 10px 0 0 0;\\n\"])));const GameContent=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 20px;\\n  flex: 1;\\n  justify-content: center;\\n  align-items: flex-start;\\n  \\n  @media (max-width: 1200px) {\\n    flex-direction: column;\\n    align-items: center;\\n  }\\n\"])));const LeftPanel=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: 20px;\\n  min-width: 320px;\\n\"])));const CenterPanel=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: 20px;\\n  align-items: center;\\n\"])));const RightPanel=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: 20px;\\n  min-width: 280px;\\n\"])));const Game=()=>{const{gameState,selectPiece,placePieceOnBoard,settlePlayer,resetGame}=useGameState();const[hoveredPosition,setHoveredPosition]=useState(null);const currentPlayer=gameState.players[gameState.currentPlayerIndex];const player=gameState.players[0];// 玩家（红色）\nconst aiPlayers=gameState.players.slice(1);// AI玩家\n// 处理拼图选择\nconst handlePieceSelect=piece=>{if(currentPlayer.color==='red'&&!piece.isUsed){selectPiece(piece);}};// 处理拼图拖拽开始\nconst handleStartDrag=(piece,e)=>{if(currentPlayer.color==='red'&&!piece.isUsed){selectPiece(piece);// 通知GameBoard开始拖拽\nconst gameBoard=document.querySelector('[data-board-grid]');if(gameBoard){const customEvent=new CustomEvent('startDragFromLibrary',{detail:{piece,clientX:e.clientX,clientY:e.clientY}});gameBoard.dispatchEvent(customEvent);}}};// 处理棋盘点击\nconst handleBoardClick=position=>{if(currentPlayer.color==='red'&&gameState.selectedPiece){const success=placePieceOnBoard(position);if(success){console.log('拼图放置成功');}else{console.log('无法在此位置放置拼图');}}};// 处理拼图放置（拖拽结束）\nconst handlePiecePlace=position=>{if(currentPlayer.color==='red'&&gameState.selectedPiece){const success=placePieceOnBoard(position);if(success){console.log('拼图放置成功');}else{console.log('无法在此位置放置拼图');}}};// 处理棋盘悬停\nconst handleBoardHover=position=>{setHoveredPosition(position);};// 处理结算\nconst handleSettle=()=>{settlePlayer();};// 处理重置游戏\nconst handleReset=()=>{resetGame();};// 检查拼图是否可以放置在指定位置\nconst canPlaceAt=(x,y)=>{if(!gameState.selectedPiece||currentPlayer.color!=='red')return false;const colorIndex=1;// 红色玩家的索引\nreturn canPlacePiece(gameState.board,gameState.selectedPiece,{x,y},colorIndex);};return/*#__PURE__*/_jsxs(GameContainer,{children:[/*#__PURE__*/_jsxs(GameHeader,{children:[/*#__PURE__*/_jsx(GameTitle,{children:\"Blockus \\u65B9\\u683C\\u5927\\u6218\"}),/*#__PURE__*/_jsx(GameSubtitle,{children:\"\\u7ECF\\u5178\\u7B56\\u7565\\u62FC\\u56FE\\u6E38\\u620F\"})]}),/*#__PURE__*/_jsxs(GameContent,{children:[/*#__PURE__*/_jsx(LeftPanel,{children:/*#__PURE__*/_jsx(PlayerPieceLibrary,{player:player,selectedPiece:gameState.selectedPiece,onPieceSelect:handlePieceSelect,onStartDrag:handleStartDrag})}),/*#__PURE__*/_jsxs(CenterPanel,{children:[/*#__PURE__*/_jsx(GameBoard,{gameState:gameState,onCellClick:handleBoardClick,onCellHover:handleBoardHover,onPiecePlace:handlePiecePlace}),/*#__PURE__*/_jsx(GameControls,{gameState:gameState,onSettle:handleSettle,onReset:handleReset})]}),/*#__PURE__*/_jsx(RightPanel,{children:/*#__PURE__*/_jsx(AIPlayersInfo,{aiPlayers:aiPlayers})})]})]});};export default Game;","map":{"version":3,"names":["React","useState","styled","useGameState","GameBoard","PlayerPieceLibrary","AIPlayersInfo","GameControls","canPlacePiece","jsx","_jsx","jsxs","_jsxs","GameContainer","div","_templateObject","_taggedTemplateLiteral","GameHeader","_templateObject2","GameTitle","h1","_templateObject3","GameSubtitle","p","_templateObject4","GameContent","_templateObject5","LeftPanel","_templateObject6","CenterPanel","_templateObject7","RightPanel","_templateObject8","Game","gameState","selectPiece","placePieceOnBoard","settlePlayer","resetGame","hoveredPosition","setHoveredPosition","currentPlayer","players","currentPlayerIndex","player","aiPlayers","slice","handlePieceSelect","piece","color","isUsed","handleStartDrag","e","gameBoard","document","querySelector","customEvent","CustomEvent","detail","clientX","clientY","dispatchEvent","handleBoardClick","position","selectedPiece","success","console","log","handlePiecePlace","handleBoardHover","handleSettle","handleReset","canPlaceAt","x","y","colorIndex","board","children","onPieceSelect","onStartDrag","onCellClick","onCellHover","onPiecePlace","onSettle","onReset"],"sources":["D:/blockus new/blockus-game/src/components/Game.tsx"],"sourcesContent":["// 主游戏组件\r\n\r\nimport React, { useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { useGameState } from '../hooks/useGameState';\r\nimport GameBoard from './GameBoard';\r\nimport PlayerPieceLibrary from './PlayerPieceLibrary';\r\nimport AIPlayersInfo from './AIPlayersInfo';\r\nimport GameControls from './GameControls';\r\nimport { Position, Piece } from '../types/game';\r\nimport { canPlacePiece } from '../utils/gameEngine';\r\n\r\nconst GameContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100vh;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  padding: 20px;\r\n`;\r\n\r\nconst GameHeader = styled.div`\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n`;\r\n\r\nconst GameTitle = styled.h1`\r\n  color: white;\r\n  font-size: 36px;\r\n  margin: 0;\r\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);\r\n`;\r\n\r\nconst GameSubtitle = styled.p`\r\n  color: rgba(255, 255, 255, 0.8);\r\n  font-size: 18px;\r\n  margin: 10px 0 0 0;\r\n`;\r\n\r\nconst GameContent = styled.div`\r\n  display: flex;\r\n  gap: 20px;\r\n  flex: 1;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n  \r\n  @media (max-width: 1200px) {\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n`;\r\n\r\nconst LeftPanel = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n  min-width: 320px;\r\n`;\r\n\r\nconst CenterPanel = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n  align-items: center;\r\n`;\r\n\r\nconst RightPanel = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n  min-width: 280px;\r\n`;\r\n\r\nconst Game: React.FC = () => {\r\n  const { gameState, selectPiece, placePieceOnBoard, settlePlayer, resetGame } = useGameState();\r\n  const [hoveredPosition, setHoveredPosition] = useState<Position | null>(null);\r\n  \r\n  const currentPlayer = gameState.players[gameState.currentPlayerIndex];\r\n  const player = gameState.players[0]; // 玩家（红色）\r\n  const aiPlayers = gameState.players.slice(1); // AI玩家\r\n  \r\n  // 处理拼图选择\r\n  const handlePieceSelect = (piece: Piece) => {\r\n    if (currentPlayer.color === 'red' && !piece.isUsed) {\r\n      selectPiece(piece);\r\n    }\r\n  };\r\n  \r\n  // 处理拼图拖拽开始\r\n  const handleStartDrag = (piece: Piece, e: React.MouseEvent) => {\r\n    if (currentPlayer.color === 'red' && !piece.isUsed) {\r\n      selectPiece(piece);\r\n      // 通知GameBoard开始拖拽\r\n      const gameBoard = document.querySelector('[data-board-grid]');\r\n      if (gameBoard) {\r\n        const customEvent = new CustomEvent('startDragFromLibrary', {\r\n          detail: { piece, clientX: e.clientX, clientY: e.clientY }\r\n        });\r\n        gameBoard.dispatchEvent(customEvent);\r\n      }\r\n    }\r\n  };\r\n  \r\n  // 处理棋盘点击\r\n  const handleBoardClick = (position: Position) => {\r\n    if (currentPlayer.color === 'red' && gameState.selectedPiece) {\r\n      const success = placePieceOnBoard(position);\r\n      if (success) {\r\n        console.log('拼图放置成功');\r\n      } else {\r\n        console.log('无法在此位置放置拼图');\r\n      }\r\n    }\r\n  };\r\n  \r\n  // 处理拼图放置（拖拽结束）\r\n  const handlePiecePlace = (position: Position) => {\r\n    if (currentPlayer.color === 'red' && gameState.selectedPiece) {\r\n      const success = placePieceOnBoard(position);\r\n      if (success) {\r\n        console.log('拼图放置成功');\r\n      } else {\r\n        console.log('无法在此位置放置拼图');\r\n      }\r\n    }\r\n  };\r\n  \r\n  // 处理棋盘悬停\r\n  const handleBoardHover = (position: Position) => {\r\n    setHoveredPosition(position);\r\n  };\r\n  \r\n  // 处理结算\r\n  const handleSettle = () => {\r\n    settlePlayer();\r\n  };\r\n  \r\n  // 处理重置游戏\r\n  const handleReset = () => {\r\n    resetGame();\r\n  };\r\n  \r\n  // 检查拼图是否可以放置在指定位置\r\n  const canPlaceAt = (x: number, y: number): boolean => {\r\n    if (!gameState.selectedPiece || currentPlayer.color !== 'red') return false;\r\n    \r\n    const colorIndex = 1; // 红色玩家的索引\r\n    return canPlacePiece(gameState.board, gameState.selectedPiece, { x, y }, colorIndex);\r\n  };\r\n  \r\n  return (\r\n    <GameContainer>\r\n      <GameHeader>\r\n        <GameTitle>Blockus 方格大战</GameTitle>\r\n        <GameSubtitle>经典策略拼图游戏</GameSubtitle>\r\n      </GameHeader>\r\n      \r\n      <GameContent>\r\n        {/* 左侧：玩家拼图库 */}\r\n        <LeftPanel>\r\n          <PlayerPieceLibrary\r\n            player={player}\r\n            selectedPiece={gameState.selectedPiece}\r\n            onPieceSelect={handlePieceSelect}\r\n            onStartDrag={handleStartDrag}\r\n          />\r\n        </LeftPanel>\r\n        \r\n        {/* 中央：游戏棋盘和控制 */}\r\n        <CenterPanel>\r\n          <GameBoard\r\n            gameState={gameState}\r\n            onCellClick={handleBoardClick}\r\n            onCellHover={handleBoardHover}\r\n            onPiecePlace={handlePiecePlace}\r\n          />\r\n          \r\n          <GameControls\r\n            gameState={gameState}\r\n            onSettle={handleSettle}\r\n            onReset={handleReset}\r\n          />\r\n        </CenterPanel>\r\n        \r\n        {/* 右侧：AI玩家信息 */}\r\n        <RightPanel>\r\n          <AIPlayersInfo aiPlayers={aiPlayers} />\r\n        </RightPanel>\r\n      </GameContent>\r\n    </GameContainer>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}